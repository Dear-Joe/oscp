##############################
#Simple alert with MessageBox
##############################
$User32 = @"
using System;
using System.Runtime.InteropServices;

public class User32 {
    [DllImport("user32.dll", CharSet=CharSet.Auto)]
    public static extern int MessageBox(IntPtr hWnd, String text, 
        String caption, int options);
}
"@

Add-Type $User32

[User32]::MessageBox(0, "This is an alert", "MyBox", 0)


############################################
#Alert containing username with GetUserName
############################################

$User32 = @"
using System;
using System.Text;
using System.Runtime.InteropServices;

public class User32 {
    [DllImport("user32.dll", CharSet=CharSet.Auto)]
    public static extern int MessageBox(IntPtr hWnd, String text, 
        String caption, int options);

    [DllImport("advapi32.dll", SetLastError = true)]
    public static extern bool GetUserName(System.Text.StringBuilder sb, ref Int32 length);

    
}
"@

Add-Type $User32

 $sb = [System.Text.StringBuilder]::new();
 $nSize=64;
 [User32]::GetUserName($sb, [ref]$nSize);

 $username = $sb.ToString()
            
[User32]::MessageBox(0, $username, "MyBox", 0)

